define("dataFixer/helpers/CompsMigrationHelper",["lodash","coreUtils"],function(a,b){"use strict";function c(a){this.migrationMap=a}return c.prototype.getComponentData=function(a,b){return b.dataQuery&&a.data.document_data[b.dataQuery.replace("#","")]},c.prototype.setComponentData=function(c,d,e,f){var g=d.dataQuery||a.get(f,[d.id,"dataQuery"])||b.guidUtils.getUniqueId("dataItem","-");g=g.replace("#",""),d.dataQuery="#"+g,e.id=g,c.data.document_data[g]=e,a.set(f,[d.id,"dataQuery"],g)},c.prototype.deleteComponentData=function(a,b){var c=b.dataQuery&&b.dataQuery.replace("#","");c&&a.data.document_data[c]&&delete a.data.document_data[c]},c.prototype.getComponentDesignData=function(a,b){return b.designQuery&&a.data.design_data[b.designQuery.replace("#","")]},c.prototype.deleteComponentDesignData=function(a,b){var c=b.designQuery&&b.designQuery.replace("#","");c&&a.data.design_data[c]&&delete a.data.design_data[c]},c.prototype.getComponentProperties=function(a,b){return b.propertyQuery&&a.data.component_properties[b.propertyQuery.replace("#","")]},c.prototype.deleteComponentProperties=function(a,b){var c=b.propertyQuery&&b.propertyQuery.replace("#","");c&&a.data.component_properties[c]&&delete a.data.component_properties[c],b.propertyQuery&&delete b.propertyQuery},c.prototype.setComponentDesignData=function(c,d,e,f){var g=d.designQuery||a.get(f,[d.id,"designQuery"])||b.guidUtils.getUniqueId("dataItem","-");if(g=g.replace("#",""),d.designQuery="#"+g,e.id=g,a.isObject(e.background)){var h=a.clone(e.background);h.id=(h.id||b.guidUtils.getUniqueId("dataItem","-")).replace("#",""),e.background="#"+h.id,c.data.design_data[h.id]=h}c.data.design_data[g]=e,a.set(f,[d.id,"designQuery"],d.designQuery)},c.prototype.setComponentProperties=function(c,d,e,f){var g=d.propertyQuery||a.get(f,[d.id,"propertyQuery"])||b.guidUtils.getUniqueId("propItem","-");g=g.replace("#",""),d.propertyQuery=g,e.id=g,c.data.component_properties[g]=e,a.set(f,[d.id,"propertyQuery"],g)},c.prototype.migrateComps=function(b,c,d,e){a.forEach(e,function(a){this.migrationMap[a.componentType]&&this.migrationMap[a.componentType].call(this,b,c,d,a),this.migrateComps(b,c,d,a.components)},this)},c.prototype.migratePage=function(a){var b=a.structure;if(b){var c={},d=b.components||b.children,e=b.mobileComponents;d&&this.migrateComps(a,c,!1,d),e&&this.migrateComps(a,c,!0,e)}},c}),define("dataFixer/maps/galleryTypes",[],function(){"use strict";return{"wysiwyg.viewer.components.MatrixGallery":{propType:"MatrixGalleryProperties"},"wysiwyg.viewer.components.PaginatedGridGallery":{propType:"PaginatedGridGalleryProperties"},"wysiwyg.viewer.components.SliderGallery":{propType:"SliderGalleryProperties"},"wysiwyg.viewer.components.SlideShowGallery":{propType:"SlideShowGalleryProperties"},"tpa.viewer.components.Masonry":{propType:"MasonryProperties"},"tpa.viewer.components.Accordion":{propType:"AccordionProperties"},"tpa.viewer.components.Impress":{propType:"ImpressProperties"},"tpa.viewer.components.Freestyle":{propType:"FreestyleProperties"},"tpa.viewer.components.Collage":{propType:"CollageProperties"},"tpa.viewer.components.Honeycomb":{propType:"HoneycombProperties"},"tpa.viewer.components.StripShowcase":{propType:"StripShowcaseProperties"},"tpa.viewer.components.StripSlideshow":{propType:"StripSlideshowProperties"},"tpa.viewer.components.Thumbnails":{propType:"ThumbnailsProperties"},"wysiwyg.viewer.components.tpapps.TPA3DGallery":{propType:"SlideShowGalleryProperties"},"wysiwyg.viewer.components.tpapps.TPA3DCarousel":{propType:"SlideShowGalleryProperties"}}}),define("dataFixer/plugins/galleriesMobileTypeFixer",["lodash","dataFixer/helpers/CompsMigrationHelper","dataFixer/maps/galleryTypes"],function(a,b,c){"use strict";function d(a,b,d,e){if(!d)return void(b[e.id]=e);var f=b[e.id];if(f.componentType!==e.componentType){var g=f.componentType;e.componentType=g;var h=this.getComponentProperties(a,e),i=c[g].propType;!g||h&&h.type===i||(e.propertyQuery=f.propertyQuery)}}return{exec:function(e){var f=a.mapValues(c,function(){return d}),g=new b(f);g.migratePage(e)}}}),define("dataFixer/plugins/pageTopFixer",[],function(){"use strict";return{exec:function(a){a.structure=a.structure||{},a.structure.layout=a.structure.layout||{},a.structure.layout.y=0}}}),define("dataFixer/helpers/runOnAllCompsRecursively",["lodash"],function(a){"use strict";function b(c,d){a.forEach(c,function(c){a.forEach(d,function(a){a(c)}),c.components&&b(c.components,d)})}return b}),define("dataFixer/plugins/masterPageFixer",["lodash","dataFixer/helpers/runOnAllCompsRecursively"],function(a,b){"use strict";function c(a){a.SITE_STRUCTURE&&(a.masterPage=a.SITE_STRUCTURE),a.masterPage||(a.masterPage={}),a.masterPage.id="masterPage",delete a.SITE_STRUCTURE}function d(b){return 0===a.get(b,"layout.width")}function e(b){return 0===a.get(b,"layout.height")}function f(b){d(b)&&a.set(b,"layout.width",100),e(b)&&a.set(b,"layout.height",100)}function g(b){a.forEach(b,function(b){a.forEach(a.get(b,"layout.anchors"),function(a){("PAGES_CONTAINER"===b.id||"SITE_FOOTER"===a.targetComponent)&&"BOTTOM_TOP"===a.type&&a.locked&&a.distance>=70&&(a.originalValue=0,a.locked=!1)})})}function h(c,g){var h=!1;if(a.forEach(["SITE_HEADER","SITE_FOOTER"],function(b){var f=a.find(c,{id:b});d(f)&&(h=!0),e(f)&&(a.set(f,"layout.height",100),h=!0),a.set(f,"layout.width",g)}),h){var i=a.reject(c,{id:"PAGES_CONTAINER"});b(i,[f])}}function i(b,c){var d=b.children,e=b.mobileComponents,f=a.get(c,"masterPage.renderModifiers.siteWidth",980);k(d),h(d,f),k(e),h(e,320),g(e)}function k(b){a.forEach(j,function(c){var d=a.find(b,"id",c.id);if(!d){var e=a.find(b,"componentType",c.componentType);e&&(e.id=c.id)}})}var j=[{componentType:"wysiwyg.viewer.components.PagesContainer",id:"PAGES_CONTAINER"},{componentType:"wysiwyg.viewer.components.FooterContainer",id:"SITE_FOOTER"},{componentType:"wysiwyg.viewer.components.HeaderContainer",id:"SITE_HEADER"}],l={exec:function(a){return a.structure&&"Document"===a.structure.type&&(a.structure.id="masterPage",c(a.data.document_data),i(a.structure,a.data.document_data)),a}};return l}),define("dataFixer/plugins/menuFixer",["lodash"],function(a){"use strict";function b(b){var c=b.MAIN_MENU,d=[];return a.forEach(c.items,function(a){if(d.push(a.refId),a.items&&a.items.length>0)for(var b=0;b<a.items.length;b++)d.push(a.items[b].refId)}),d}function c(b,c){var d=b.items[c];d.items&&d.items.length>0&&a.forEach(d.items,function(a,c){b.items.push(a),delete d.items[c]}),d.items=[],b.items.splice(c,1)}function d(b,c){var d={};return a.find(b.items,function(b,e){return d.topIndex=e,a.find(b.items,function(a,b){return a.refId===c?(d.subIndex=b,!0):void 0})}),d}function e(b,e){var f=a.findIndex(b.items,{refId:e});if(f>=0)c(b,f);else{var g=d(b,e);b.items[g.topIndex].items.splice(g.subIndex,1)}}function f(b,c){var d=b.MAIN_MENU;a.forEach(c,function(a){a||e(d,a)}),a.pull(c,"",void 0)}function g(b,c,d){a.forEach(c,function(c){a.includes(d,c.slice(1))||e(b.MAIN_MENU,c)})}function h(b,c,d){var e=b.MAIN_MENU,f=0===e.items.length,g=!!b.CUSTOM_MAIN_MENU;if(g){if(f)return;delete b.CUSTOM_MAIN_MENU,delete b.CUSTOM_MENUS}a.forEach(d,function(b){if(!a.includes(c,"#"+b)){c.push("#"+b);var d={items:[],refId:"#"+b};e.items.push(d)}})}function i(b,c){b&&b.mainPage&&!a.includes(c,b.mainPage.slice(1))&&(b.mainPage="#"+c[0])}function j(a){var b=!!a.CUSTOM_MAIN_MENU;if(b)for(var c=a.CUSTOM_MAIN_MENU.items,d=0;d<c.length;d++)if(!a[c[d].replace("#","")])return delete a.CUSTOM_MAIN_MENU,void delete a.CUSTOM_MENUS}function k(b){return"Document"===a.get(b,"structure.type")}var l={exec:function(a,c){var d=a.data.document_data;if(k(a)&&!a.data.document_data.MAIN_MENU&&(a.data.document_data.MAIN_MENU={items:[],type:"Menu",id:"MAIN_MENU",metaData:{}}),d.MAIN_MENU&&c){var e=b(d);j(d),f(d,e),g(d,e,c),h(d,e,c);var l=d.masterPage;i(l,c)}}};return l}),define("dataFixer/plugins/verticalMenuFixer",["lodash","coreUtils"],function(a,b){"use strict";function i(a){return!!a.data.theme_data.THEME_DATA}function j(a){d=a.data.theme_data}function k(b){var c=b.data.document_data,d=c.CUSTOM_MAIN_MENU||{items:[]};e=a.filter(d.items,function(a){return c[a.replace("#","")].isVisible}).length}function l(a,b,c,d){var e=o(a,b);b.layout.height=d,e.originalHeight=c}function m(b,c){var d=o(b,c);return!a.isUndefined(d.originalHeight)}function n(a,b){return"wysiwyg.common.components.verticalmenu.viewer.VerticalMenu"===b.componentType&&!m(a,b)}function o(a,b){return a.data.component_properties[b.propertyQuery.replace("#","")]}function p(a,b){return a.data.theme_data[b.styleId]||d[b.styleId]}function q(c,d){var f=p(c,d);f||b.log.error("cannot find style");var i=parseInt(f.style.properties.sepw||f.style.properties.separatorHeight||0,10),j=a.includes(g,f.skin),k=a.includes(h,f.skin),m=d.layout.height,n=b.verticalMenuCalculations.getFixedHeight(m,i,j,k,e);l(c,d,m,n)}function r(b,c){a.forEach(c,function(a){n(b,a)&&q(b,a),a.components&&r(b,a.components)})}function s(a){var b=a.structure;b&&(b.components&&r(a,b.components),b.mobileComponents&&r(a,b.mobileComponents),b.children&&r(a,b.children))}var c=!1,d={},e=0,f=[],g=["wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonFixedWidthSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSolidColorSkin"],h=["wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonFixedWidthSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonSkin"],t={exec:function(a){if(i(a))for(j(a),k(a),c=!0;f.length>0;)s(f.pop());else c?s(a):f.push(a)}};return t}),define("dataFixer/plugins/skinFixer",["lodash","experiment"],function(a,b){"use strict";function d(a){a.skin&&c[a.skin]&&(a.skin=c[a.skin])}function e(a,b){var c,g,f=a[b]||a.components;if(f)for(c=0;c<f.length;c++)g=f[c],d(g),e(g,b)}var c={"mobile.core.skins.InlineSkin":"skins.core.VerySimpleSkin","mobile.core.skins.TwitterTweetSkin":"skins.core.TwitterTweetSkin","mobile.core.skins.ButtonSkin":"skins.core.ButtonSkin","mobile.core.skins.ContactItemSkin":"skins.core.ContactItemSkin","mobile.core.skins.ContactListSkin":"skins.core.ContactListSkin","mobile.core.skins.FacebookCommentSkin":"skins.core.FacebookCommentSkin","mobile.core.skins.GlobalMenuSkin":"skins.core.GlobalMenuSkin","mobile.core.skins.GooglePlusOneSkin":"skins.core.GooglePlusOneSkin","mobile.core.skins.HeaderSkin":"skins.core.HeaderSkin","mobile.core.skins.HomeButtonSkin":"skins.core.HomeButtonSkin","mobile.core.skins.ImageNewSkin":"skins.core.ImageNewSkin","mobile.core.skins.ImageSkin":"skins.core.ImageSkin","mobile.core.skins.MenuButtonSkin":"skins.core.MenuButtonSkin","mobile.core.skins.NetworkItemSkin":"skins.core.NetworkItemSkin","mobile.core.skins.NetworkListSkin":"skins.core.NetworkListSkin","mobile.core.skins.PageTitleSkin":"skins.core.PageTitleSkin","mobile.core.skins.PhotoFullScreenSkin":"skins.core.PhotoFullScreenSkin","mobile.core.skins.PhotoGalleryFullScreenDefaultSkin":"skins.core.PhotoGalleryFullScreenDefaultSkin","mobile.core.skins.PhotoGalleryGridDefaultSkin":"skins.core.PhotoGalleryGridDefaultSkin","mobile.core.skins.PhotoSkin":"skins.core.PhotoSkin","mobile.core.skins.RichTextImageSkin":"skins.core.RichTextImageSkin","mobile.core.skins.RichTextSkin":"skins.core.RichTextSkin","mobile.core.skins.ServiceItemSkin":"skins.core.ServiceItemSkin","mobile.core.skins.ServiceListSkin":"skins.core.ServiceListSkin","mobile.core.skins.SimpleButtonSkin":"skins.core.SimpleButtonSkin","mobile.core.skins.SiteNavigationMenuSkin":"skins.core.SiteNavigationMenuSkin","mobile.core.skins.TwitterFollowSkin":"skins.core.TwitterFollowSkin","mobile.core.skins.FacebookLikeSkin":"skins.core.FacebookLikeSkin","skins.viewer.gallerymatrix.PolaroidCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.PolaroidCustomHeightSkin","skins.viewer.gallerymatrix.PolaroidDisplayerCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.PolaroidDisplayerCustomHeightSkin","skins.viewer.gallerymatrix.TextBottomCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.TextBottomCustomHeightSkin","skins.viewer.gallerymatrix.TextBottomDisplayerCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.TextBottomDisplayerCustomHeightSkin","skins.viewer.galleryslider.SliderGalleryScotchTapeSkin":"wysiwyg.viewer.skins.galleryslider.SliderGalleryScotchTapeSkin","skins.viewer.galleryslider.SliderGalleryIronSkin":"wysiwyg.viewer.skins.galleryslider.SliderGalleryIronSkin","skins.viewer.galleryslider.SliderDisplayerIronSkin":"wysiwyg.viewer.skins.galleryslider.SliderDisplayerIronSkin","skins.viewer.galleryslider.SliderDisplayerScotchTapeSkin":"wysiwyg.viewer.skins.galleryslider.SliderDisplayerScotchTapeSkin","wysiwyg.viewer.skins.gallerymatrix.MatrixGallerySeparateTextBoxSkin":"wysiwyg.common.components.matrixgallery.viewer.skins.MatrixGallerySeparateTextBoxSkin","wysiwyg.viewer.skins.gallerymatrix.MatrixGalleryTextOnCenterSkin":"wysiwyg.common.components.matrixgallery.viewer.skins.MatrixGalleryTextOnCenterSkin","wysiwyg.viewer.skins.dropmenu.TextOnlyMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextOnlyMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.TextSeparatorsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextSeparatorsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SolidColorMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SolidColorMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.ShinyMenuINSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIButtonSkin","wysiwyg.viewer.skins.dropmenu.ShinyMenuIINSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.dropmenu.OverlineMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.OverlineMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateBasicMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateBasicMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateShinyIMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateShinyIIMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIIMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.LinesMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.LinesMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateLinesMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateLinesMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.PointerMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.PointerMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.RibbonsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.RibbonsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.VerticalRibbonsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.VerticalRibbonsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.IndentedMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.IndentedMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateIndentedMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateIndentedMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.ArrowRightMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ArrowRightMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SloppyBorderMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SloppyBorderMenuButtonSkin","wysiwyg.viewer.skins.menu.ShinyMenuISkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.menu.ShinyMenuIISkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.menu.TextOnlyMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextOnlyMenuButtonBgFixSkin","wysiwyg.viewer.skins.menu.TextSeparatorsMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextSeparatorsMenuButtonSkin","wysiwyg.viewer.skins.menu.SolidColorMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SolidColorMenuButtonSkin","wysiwyg.viewer.skins.menu.OverlineMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.OverlineMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.SeparateBasicMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateBasicMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateShinyIMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateShinyIIMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIIMenuButtonBorderRadiusFixSkin","wysiwyg.viewer.skins.menu.LinesMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.LinesMenuButtonBorderRadiusFixSkin","wysiwyg.viewer.skins.menu.SeparateLinesMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateLinesMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.PointerMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.PointerMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.RibbonsMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.RibbonsMenuButtonSkin","wysiwyg.viewer.skins.menu.IndentedMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.IndentedMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateIndentedMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateIndentedMenuButtonSkin","wysiwyg.viewer.skins.menu.ArrowRightMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ArrowRightMenuButtonSkin","wysiwyg.viewer.skins.menu.SloppyBorderMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SloppyBorderMenuButtonSkin","tpa.viewer.skins.TPAMasonrySkin":"wysiwyg.viewer.skins.TPAMasonrySkin","tpa.viewer.skins.TPA3DCarouselSkin":"wysiwyg.viewer.skins.TPA3DCarouselSkin","tpa.viewer.skins.TPA3DGallerySkin":"wysiwyg.viewer.skins.TPA3DGallerySkin","tpa.viewer.skins.TPAAccordionSkin":"wysiwyg.viewer.skins.TPAAccordionSkin","tpa.viewer.skins.TPACollageSkin":"wysiwyg.viewer.skins.TPACollageSkin","tpa.viewer.skins.TPAEcomGallerySkin":"wysiwyg.viewer.skins.TPAEcomGallerySkin","tpa.viewer.skins.TPAFreestyleSkin":"wysiwyg.viewer.skins.TPAFreestyleSkin","tpa.viewer.skins.TPAHoneycombSkin":"wysiwyg.viewer.skins.TPAHoneycombSkin","tpa.viewer.skins.TPAImpressSkin":"wysiwyg.viewer.skins.TPAImpressSkin","tpa.viewer.skins.TPAStripShowcaseSkin":"wysiwyg.viewer.skins.TPAStripShowcaseSkin","tpa.viewer.skins.TPAStripSlideshowSkin":"wysiwyg.viewer.skins.TPAStripSlideshowSkin","tpa.viewer.skins.TPAThumbnailsSkin":"wysiwyg.viewer.skins.TPAThumbnailsSkin","tpa.common.skins.TPAPreloaderSkin":"wysiwyg.viewer.skins.TPAPreloaderSkin","tpa.common.skins.TPAUnavailableMessageOverlaySkin":"wysiwyg.viewer.skins.TPAUnavailableMessageOverlaySkin"};b.isOpen("migrateTextStyle")&&(c["wysiwyg.viewer.skins.WRichTextSkin"]="wysiwyg.viewer.skins.WRichTextNewSkin");var f={exec:function(b){var f,c=b.structure;c&&(e(c,"children"),e(c,"mobileComponents"),d(c)),f=b.data&&b.data.theme_data,f&&a.forEach(f,function(a){d(a)})}};return f}),define("dataFixer/plugins/stylesFixer",["lodash","experiment"],function(a,b){"use strict";function d(a,b,c){return a[c.replace("llt_","llf_")]=b,a}function g(b){b.style&&a.forEach(b.style.properties,function(a,b,c){"string"==typeof a&&(c[b]=a.replace(/(\d)x/g,"$1px"))})}function h(){var a={type:"TopLevelStyle",id:"v2",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},style:{properties:{brd:"color_15",brw:"0px",rd:"0px",shd:"0 1px 4px rgba(0, 0, 0, 0.6);"},propertiesSource:{brd:"theme",brw:"value",rd:"value",shd:"value"},groups:{}},componentClassName:"",pageId:"",compId:"",styleType:"system",skin:"wysiwyg.viewer.skins.video.VideoDefault"};return a}function i(){return{type:"TopLevelStyle",id:"txtNew",metaData:{isPreset:!0,schemaVersion:"1.0",isHidden:!1},styleType:"system",skin:"wysiwyg.viewer.skins.WRichTextNewSkin",style:{properties:{},propertiesSource:{},groups:{}}}}function j(b){if(!b.v2){var c=h();b.v2=a.cloneDeep(b.vl)||c}b.txtNew||(b.txtNew=i())}function k(b){a.forOwn(b,function(a){f["*"](a),f[a.skin]&&f[a.skin](a)}),c&&"wysiwyg.viewer.skins.WRichTextSkin"===b.txtNew.skin&&(b.txtNew.skin="wysiwyg.viewer.skins.WRichTextNewSkin")}var c=b.isOpen("migrateTextStyle"),e=function(b){b.style.properties=a.reduce(b.style.properties,d,{}),b.style.propertiesSource=a.reduce(b.style.propertiesSource,d,{})},f={"*":function(a){"THEME_DATA"!==a.id&&(a.style||(a.style={properties:{},propertiesSource:{},groups:{}}))},"wysiwyg.common.components.subscribeform.viewer.skins.SubscribeFormLineLayoutFlat":e,"wysiwyg.common.components.subscribeform.viewer.skins.SubscribeFormLineLayoutTransparentWithIcon":e},l={exec:function(b){var c=b.data&&b.data.theme_data;a.isEmpty(c)||(j(c),k(c),a.forEach(c,function(a){g(a)}))}};return l}),define("dataFixer/plugins/bgImageStripDataFixer",["lodash"],function(a){"use strict";function c(a){return a&&"wysiwyg.viewer.components.BgImageStrip"===a.componentType}function d(a){return a&&a.dataQuery&&a.dataQuery.replace("#","")}function e(a){return a.uri.slice(0-b.length)===b}function f(a,b,f){if(c(f)){var g=d(f),h=g&&b[g];h&&(h.title=h.title||"",e(h)||(a[f.id]=g))}}function g(a,b,d){if(c(d)){var e=a[d.id];e?d.dataQuery="#"+e:delete d.dataQuery}}function h(b,c){a.forEach(b,function(a){c(a),h(a.components,c)})}var b="add_image_thumb.png";return{exec:function(a){var b=a.structure,c=b&&(b.components||b.children),d=b&&b.mobileComponents;if(c){var e={};h(c,f.bind(null,e,a.data.document_data)),h(c,g.bind(null,e,a.data.document_data)),h(d,g.bind(null,e,a.data.document_data))}}}}),define("dataFixer/plugins/compFixer",["lodash","coreUtils","experiment"],function(a,b,c){"use strict";function e(a,b){var c=b.componentType,e=d[c];e&&(b.componentType=e.comp,e.dataQuery&&(b.dataQuery=e.dataQuery),e.callback&&e.callback(a))}function f(a,b){"wysiwyg.viewer.components.ItunesButton"===b.componentType&&(b.layout.height=Math.round(b.layout.width/2.75))}function g(a,b){return a.data.component_properties[b.propertyQuery]}function h(a,b){return b.dataQuery&&a.data.document_data[b.dataQuery.replace("#","")]}function i(a,b,c){a.data.component_properties[b.propertyQuery]=c}function j(a,c,d){var e=b.guidUtils.getUniqueId("dataItem","-");c.dataQuery="#"+e,d.id=e,a.data.document_data[e]=d}function k(b){if(b.components.length>0){var c=a.map(b.components,function(a){return a.layout.y+a.layout.height});return a.max(c)}return 0}function l(b){var c=a.find(b.structure.children,{id:"PAGES_CONTAINER"});return c.layout.y+c.layout.height}function m(a,b){"SITE_FOOTER"!==b.id||b.layout||(b.layout={anchors:[],fixedPosition:!1,height:k(b),rotationInDegrees:0,scale:1,width:320,x:0,y:l(a)})}function n(a,b){if(!h(a,b))switch(b.componentType){case"wysiwyg.viewer.components.svgshape.SvgShape":j(a,b,{link:null,type:"SvgShape"});break;case"wysiwyg.viewer.components.WFacebookComment":return void j(a,b,{type:"WFacebookComment",urlFormat:"hashBang"});case"wysiwyg.viewer.components.WFacebookLike":return void j(a,b,{type:"WFacebookLike",urlFormat:"hashBang"})}}function o(a,b){var c=h(a,b);if(c)switch(b.componentType){case"wysiwyg.viewer.components.ClipArt":return void(c.title="");case"wysiwyg.viewer.components.FacebookShare":return void(c.urlFormat=c.urlFormat||"hashBang");case"wysiwyg.viewer.components.VKShareButton":return void(c.urlFormat=c.urlFormat||"hashBang");case"wysiwyg.common.components.pinterestpinit.viewer.PinterestPinIt":return void(c.urlFormat=c.urlFormat||"hashBang");case"wysiwyg.viewer.components.WTwitterTweet":return void(c.urlFormat=c.urlFormat||"hashBang");case"wysiwyg.viewer.components.WFacebookComment":return void(c.urlFormat=c.urlFormat||"hashBang");case"wysiwyg.viewer.components.WFacebookLike":return void(c.urlFormat=c.urlFormat||"hashBang")}}function p(a,b){if(!g(a,b))switch(b.componentType){case"wysiwyg.viewer.components.menus.DropDownMenu":i(a,b,{alignButtons:"center",alignText:"center",sameWidthButtons:!1,moreButtonLabel:"More",moreItemHeight:15,stretchButtonsToMenuWidth:!0,type:"HorizontalMenuProperties"});break;case"wysiwyg.viewer.components.mobile.TinyMenu":var c="TINY_MENU";b.propertyQuery=c,i(a,b,{direction:"left",type:"TinyMenuProperties",id:c,metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}})}}function q(a,b,c){a.properties[c.id]=g(b,c)}function r(a,b,c){!g(b,c)&&a.properties[c.id]&&i(b,c,a.properties[c.id])}function s(a,b){var c=g(a,b);if(b.propertyQuery&&c)switch(b.componentType){case"wysiwyg.viewer.components.WFacebookLike":c.language||(c.language="en");break;case"wysiwyg.viewer.components.PayPalButton":c.language||(c.language="en");break;case"wysiwyg.viewer.components.GoogleMap":c.language||(c.language="en");break;case"wysiwyg.viewer.components.WRichText":"WRichTextProperties"!==c.type&&delete b.propertyQuery}}function t(b,c,d){if("wysiwyg.viewer.components.WRichText"===d.componentType){var e=g(c,d);e&&e.packed||a.set(c,["structure",b],!1)}}function u(b,c,d){a.forEach(c,function(c){a.forEach(d,function(a){a(b,c)}),c.components&&u(b,c.components,d)})}function v(b,d,g){var h=a.noop;c.isOpen("viewerGeneratedAnchors")&&window.publicModel&&(b.structure.isPagePackedDesktop=!0,h=a.partial(t,"isPagePackedDesktop")),u(b,g,[e,f,n,p,s,o,h,a.partial(q,d)])}function w(b,d,g){var h=a.noop;c.isOpen("viewerGeneratedAnchors")&&window.publicModel&&(b.structure.isPagePackedMobile=!0,h=a.partial(t,"isPagePackedMobile")),u(b,g,[e,f,n,p,s,o,h,m,a.partial(r,d)])}var d={"wysiwyg.viewer.components.HorizontalMenu":{comp:"wysiwyg.viewer.components.menus.DropDownMenu",dataQuery:"#MAIN_MENU"}},x={exec:function(a){var b=a.structure;if(b){var c={properties:{}},d=b.components||b.children,e=b.mobileComponents;d&&v(a,c,d),e&&w(a,c,e)}}};return x}),define("dataFixer/plugins/galleryFixer",["lodash"],function(a){"use strict";var b=["GalleryExpandProperties","MatrixGalleryProperties","PaginatedGridGalleryProperties","SliderGalleryProperties","SlideShowGalleryProperties"],c=function(b){return(a.isUndefined(b.galleryImageOnClickAction)||"unset"===b.galleryImageOnClickAction)&&(b.expandEnabled===!1?b.galleryImageOnClickAction="disabled":b.galleryImageOnClickAction="zoomMode"),b},d=function(b,c,d){return a(b).pick(function(b){return a.includes(c,b.type)}).mapValues(d).value()},e={exec:function(a){d(a.data.component_properties,b,c)}};return e}),define("dataFixer/helpers/behaviorsMigrationHelper",["coreUtils"],function(a){"use strict";function b(b){var c={id:a.guidUtils.getUniqueId("behavior","-"),type:"ObsoleteBehaviorsList",items:b};return c}return{createBehaviorsDataItem:b}}),define("dataFixer/plugins/behaviorsDataFixer",["lodash","coreUtils","dataFixer/helpers/behaviorsMigrationHelper"],function(a,b,c){"use strict";function d(c){var d=b.dataUtils.getAllCompsInStructure(c,!1);return a.pick(d,function(a){return a.behaviors})}function e(c,d){var e=b.dataUtils.getAllCompsInStructure(c,!0);return a.pick(e,function(a){return d[a.id]})}function f(a,b,c){a.behaviorQuery=b.id,c&&(c.behaviorQuery=a.behaviorQuery)}function g(b){var g=a.get(b,"data"),h=a.get(b,"structure");g.behaviors_data=g.behaviors_data||{};var i=d(h),j=e(h,i);a.forEach(i,function(b){var d=c.createBehaviorsDataItem(b.behaviors);f(b,d,j[b.id]),delete b.behaviors,a.set(g,["behaviors_data",d.id],d)})}return{exec:g}}),define("dataFixer/plugins/behaviorsFixer",["lodash","dataFixer/plugins/behaviorsDataFixer"],function(a,b){"use strict";function c(a){return["behaviors_data",a.behaviorQuery,"items"]}function d(b){return a.has(b,"behaviors_data")}function e(b,e,f){var g=JSON.stringify(b);d(f)?a.set(f,c(e),g):e.behaviors=g}function f(b,e){return d(e)?a.get(e,c(b),"[]"):b.behaviors||"[]"}function g(b,c){var g=[],h=f(b,c),i=JSON.parse(h);return a.isEmpty(i)?void(d(c)?delete b.behaviorQuery:delete b.behaviors):void(a.isArray(i)||(a.forEach(i,function(b,c){a.forEach(b,function(b,d){a.forEach(b,function(b){var e=a.assign({targetId:d,action:c},b);"screenIn"!==c&&"pageIn"!==c||(e.targetId=""),g.push(e)})})}),e(g,b,c)))}function h(b,c){a.forEach(b,function(a){g(a,c),a.components&&h(a.components,c)})}var i={exec:function(a){b.exec(a);var c=a.structure;c&&(c.components&&h(c.components,a.data),c.mobileComponents&&h(c.mobileComponents,a.data),c.children&&h(c.children,a.data))}};return i}),define("dataFixer/plugins/connectionsDataFixer",["lodash","experiment"],function(a,b){"use strict";var c={exec:function(c){if(b.isOpen("connectionsData")){var d=a.get(c,"data");d.connections_data=d.connections_data||{}}}};return c}),define("dataFixer/plugins/fiveGridLineLayoutFixer",["lodash"],function(a){"use strict";function c(d){a.forEach(d,function(d){if(a.has(b,d.skin)){var e=b[d.skin];d.layout=a.mapValues(d.layout,function(a,b){return e[b]?Math.max(a,e[b]):a})}d.components&&c(d.components)})}var b={"wysiwyg.viewer.skins.line.FadeLine":{width:90},"wysiwyg.viewer.skins.line.FadeNotchBottomLine":{width:60},"wysiwyg.viewer.skins.line.FadeNotchTopLine":{width:60},"wysiwyg.viewer.skins.line.ShadowBottomLine":{width:200},"wysiwyg.viewer.skins.line.ShadowTopLine":{width:200}},d={exec:function(a){var b=a.structure;b&&(b.components&&c(b.components),b.children&&c(b.children),b.mobileComponents&&c(b.mobileComponents))}};return d}),define("dataFixer/plugins/toPageAnchorsFixer",["lodash"],function(a){"use strict";function b(a){return!(a.length&&a[0].layout&&a[0].layout.anchors)}var c={exec:function(c){var d=c.structure;if(d&&d.components&&!a.isEmpty(d.components)&&!b(d.components)){var f,e=a.max(d.components,function(b){var c=-1*Number.MAX_VALUE;return b.layout&&a.isNumber(b.layout.y)&&a.isNumber(b.layout.height)&&(c=b.layout.y+b.layout.height),c});e.layout&&e.layout.anchors&&(f=a.find(e.layout.anchors,{type:"BOTTOM_PARENT"})),f||(e.layout=e.layout||{},e.layout.anchors=e.layout.anchors||[],e.layout.anchors.push({distance:0,type:"BOTTOM_PARENT",targetComponent:c.structure.id,locked:!0,originalValue:c.structure.layout.height,topToTop:e.layout.y}))}}};return c}),define("dataFixer/helpers/anchorCyclesHelper",["lodash"],function(a){"use strict";function c(a){return a&&a.layout&&a.layout.y+a.layout.height}function d(a){return a.layout&&a.layout.anchors||[]}function e(d,e,f){var g;switch(d.type){case b.BOTTOM_BOTTOM:g=c(f);break;case b.BOTTOM_TOP:g=a.get(f,"layout.y");break;default:return!1}return a.isUndefined(g)?!1:g-c(e)<0}function f(a){return a.type===b.BOTTOM_BOTTOM||a.type===b.BOTTOM_TOP}function g(b,c,e,h){if(h[c.id])return!1;h[c.id]=!0;var i=d(c);return i=a.filter(i,f),a.some(i,function(a){return a.targetComponent===b.id||g(b,e[a.targetComponent],e,h)})}function h(b){if(!a.isEmpty(b)){var c=a.indexBy(b,"id");a.forEach(b,function(b){var i=d(b);a.remove(i,function(a){return f(a)&&e(a,b,c[a.targetComponent])&&g(b,c[a.targetComponent],c,{})}),h(b.components)})}}var b={BOTTOM_BOTTOM:"BOTTOM_BOTTOM",BOTTOM_TOP:"BOTTOM_TOP"};return{fixBottomTopBottomBottomCycles:h}}),define("dataFixer/plugins/wrongAnchorsFixer",["lodash","dataFixer/helpers/anchorCyclesHelper"],function(a,b){"use strict";function e(a){d[a.componentType]&&(a.layout.anchors=[])}function f(a){"TOP_TOP"===a.type&&(a.locked=!0)}function g(a,b,c){var d=(c||0)*Math.PI/180;return parseInt(Math.abs(b*Math.sin(d))+Math.abs(a*Math.cos(d)),10)}function h(a,b,c){return parseInt(a-(c-b)/2,10)}function i(a){return a.layout&&a.layout.y+a.layout.height}function j(a){return a.layout&&a.layout.anchors||[]}function k(b,c,d,e,f){if(!(f[b.id]||i(b)>d)){f[b.id]=!0;var g=j(b);a.remove(g,function(a){if(a.targetComponent===c.id)return!0;if("BOTTOM_PARENT"!==a.type){if(!e[a.targetComponent])return!0;k(e[a.targetComponent],c,d,e,f)}return!1})}}function l(b,c,d){if("BOTTOM_TOP"===b.type){var e=d[b.targetComponent],f=j(e);a.remove(f,{targetComponent:c.id});var g=a.filter(f,{type:"TOP_TOP"}),h=i(c)+10;a.forEach(g,function(a){d[a.targetComponent]&&k(d[a.targetComponent],c,h,d,{})})}}function m(b,c){"Document"===b.type&&a.forEach(c,function(a){"SITE_STRUCTURE"===a.targetComponent&&(a.targetComponent="masterPage")})}function n(b,c,d){c=a.reject(c,{type:"BOTTOM_PARENT"}),a.forEach(c,function(c){
var e=d[c.targetComponent];if(e){var f=a.filter(j(e),{targetComponent:b.id,type:c.type});a.forEach(f,function(d){var f=b.layout.y<e.layout.y?e:b,g=b.layout.y<e.layout.y?d:c;a.remove(f.layout.anchors,function(a){return a===g})})}})}function o(b){a.forEach(b,function(c){var d=j(c);d=a.reject(d,{type:"BOTTOM_PARENT"}),a.remove(d,function(c){return!a.some(b,{id:c.targetComponent})})})}function p(b,e,f){var i=e.id,j=f[b.targetComponent];if("BOTTOM_PARENT"===b.type&&(j=b.targetComponent===i?e:null),!j)return!1;if("BOTTOM_BOTTOM"===b.type&&c[j.componentType])return!1;if("BOTTOM_PARENT"!==b.type&&(d[j.componentType]||"wysiwyg.viewer.components.HeaderContainer"===j.componentType&&j.layout&&j.layout.fixedPosition===!0))return!1;var k;if(j.layout&&a.isNumber(j.layout.height)&&a.isNumber(j.layout.y)){var l=j.layout,m=g(l.height,l.width,l.rotationInDegrees),n=h(l.y,l.height,m);k="BOTTOM_PARENT"===b.type||"BOTTOM_BOTTOM"===b.type?m:n}else k=0;return b.originalValue=Math.min(b.originalValue,k),!0}function q(b){a.remove(b,function(a){return null===a.distance||isNaN(a.distance)})}function r(a,b){var c=!!b;c&&e(a)}function s(a,b){return r(a,b),t(a,b)}function t(b,c){var d=c?b[c]:b.components;if(!a.isEmpty(d)){var g=a.transform(d,function(a,b){a[b.id]=b},{},this);o(d),a.forEach(d,function(c){var d=j(c);q(d),e(c),m(b,d),n(c,d,g),a.remove(d,function(a){f(a);var d=p(a,b,g);return d&&l(a,c,g),!d}),t(c)})}}function u(a){return!(a&&a.length&&a[0].layout&&a[0].layout.anchors)}var c={"wysiwyg.common.components.anchor.viewer.Anchor":!0,"wysiwyg.common.components.subscribeform.viewer.SubscribeForm":!0,"wysiwyg.common.components.pinitpinwidget.viewer.PinItPinWidget":!0,"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":!0,"wixapps.integration.components.AppPart":!0,"wixapps.integration.components.AppPart2":!0,"wixapps.integration.components.common.minipart":!0,"wysiwyg.common.components.onlineclock.viewer.OnlineClock":!0,"wysiwyg.common.components.weather.viewer.Weather":!0,"wysiwyg.common.components.skypecallbutton.viewer.SkypeCallButton":!0,"wysiwyg.common.components.spotifyfollow.viewer.SpotifyFollow":!0,"wysiwyg.common.components.spotifyplayer.viewer.SpotifyPlayer":!0,"wysiwyg.common.components.youtubesubscribebutton.viewer.YouTubeSubscribeButton":!0,"wysiwyg.viewer.components.ContactForm":!0,"wysiwyg.viewer.components.FacebookShare":!0,"wysiwyg.viewer.components.FiveGridLine":!0,"wysiwyg.viewer.components.FlickrBadgeWidget":!0,"wysiwyg.viewer.components.ItunesButton":!0,"wysiwyg.viewer.components.LinkBar":!0,"wysiwyg.viewer.components.PayPalButton":!0,"wysiwyg.viewer.components.PinterestFollow":!0,"wysiwyg.viewer.components.VKShareButton":!0,"wysiwyg.viewer.components.WFacebookComment":!0,"wysiwyg.viewer.components.WGooglePlusOne":!0,"wysiwyg.viewer.components.mobile.TinyMenu":!0},d={"wysiwyg.common.components.backtotopbutton.viewer.BackToTopButton":!0,"wysiwyg.viewer.components.tpapps.TPAGluedWidget":!0,"mobile.core.components.Page":!0,"wixapps.integration.components.AppPage":!0},v={exec:function(c){var d=c.structure,e="components";d&&("Document"===d.type&&(d=a.clone(c.structure),d.id="masterPage",c.structure=d,e="children"),u(d[e])||s(d,e),u(d.mobileComponents)||(s(d,"mobileComponents"),b.fixBottomTopBottomBottomCycles(d.mobileComponents)))}};return v}),define("dataFixer/plugins/addMissingAnchorsOfMasterPage",["lodash"],function(a){"use strict";function b(a){return a*Math.PI/180}function c(a){if(!a.rotationInDegrees)return a.height;var c=b(a.rotationInDegrees);return parseInt(Math.abs(a.width*Math.sin(c))+Math.abs(a.height*Math.cos(c)),10)}function d(a){if(!a.rotationInDegrees)return a.y;var b=c(a);return parseInt(a.y-(b-a.height)/2,10)}function e(b){return a.max(b,function(a){return d(a.layout)})}function f(b){var c=b.pagesContainer,d=b.header;c&&d&&(a.remove(c.layout.anchors,{targetComponent:"SITE_HEADER",type:"TOP_TOP"}),a.remove(d.layout.anchors,{targetComponent:"PAGES_CONTAINER",type:"TOP_TOP"}))}function g(b,f){var g=f.pagesContainer,h=f.header,i=f.footer,j=g&&g.components&&a.find(g.components,{id:"SITE_PAGES"});if(!j||!j.layout||j.layout.anchors&&0!==j.layout.anchors.length||(j.layout.anchors=[{distance:0,locked:!0,originalValue:0,targetComponent:"PAGES_CONTAINER",type:"BOTTOM_PARENT"}]),g&&g.layout&&(!g.layout.anchors||0===g.layout.anchors.length)&&i&&i.layout&&!i.layout.fixedPosition&&(g.layout.anchors=[{distance:10,locked:!0,originalValue:0,targetComponent:"SITE_FOOTER",type:"BOTTOM_TOP"}]),h){var k=a.find(b,function(b){return a.find(b.layout.anchors,{type:"BOTTOM_PARENT",targetComponent:"masterPage"})});if(!k){var l=e(b);if(!l.layout.anchors)return;l.layout.anchors.push({distance:0,locked:!0,originalValue:d(l.layout)+c(l.layout)+(h?c(h.layout):0),targetComponent:"masterPage",type:"BOTTOM_PARENT"})}}}function h(a){return!(a.length&&a[0].layout&&a[0].layout.anchors)}function i(b){var c={};return a.forEach(b,function(a){switch(a.id){case"SITE_HEADER":return c.header=a,!(c.footer&&c.pagesContainer);case"SITE_FOOTER":return c.footer=a,!(c.header&&c.pagesContainer);case"PAGES_CONTAINER":return c.pagesContainer=a,!(c.header&&c.footer);default:return!0}}),c}function j(b){if(b&&!a.isEmpty(b)&&!h(b)){var c=i(b);f(c),g(b,c)}}var k={exec:function(a){var b=a.structure;b&&"Document"===b.type&&(j(b.children),j(b.mobileComponents))},test:{getBoundingHeight:c,getBoundingY:d,getLowestComp:e}};return k}),define("dataFixer/plugins/customSiteMenuFixer",["lodash"],function(a){"use strict";function f(b,c){return a.map(b,function(a){return g(c,a)})}function g(a,c){var e=d+b++,g=a[c.refId.replace("#","")];return a[e]={id:e,label:g.title,isVisible:!g.hidePage,isVisibleMobile:void 0!==g.mobileHidePage?!g.mobileHidePage:!g.hidePage,items:f(c.items,a),link:h(a,c.refId),type:"BasicMenuItem",metaData:{}},"#"+e}function h(a,b){var d=e+c++;return a[d]={id:d,type:"PageLink",pageId:b,metaData:{}},"#"+d}function i(a,b){return b&&a[b.replace("#","")]}function j(a,b){b.link="#CUSTOM_MENU_HEADER"}function k(a,b){var c=i(a,b.link);return c&&"PageLink"===c.type&&!i(a,c.pageId)}function l(b,c){a.forEach(c.items,function(a){var c=i(b,a);c.link&&!k(b,c)||j(a,c),l(b,c)})}function m(b){a(b.data.document_data).where({type:"Menu"}).pluck("id").forEach(function(a){delete b.data.document_data[a]}).value()}function n(a){return a&&a.structure&&"Page"===a.structure.type}function o(a){return a.replace("#","")}function p(b,c){var d=b.CUSTOM_MAIN_MENU.items,e=a(b).filter({type:"BasicMenuItem"}).map("link").compact().map(o).map(function(a){return b[a]}).map("pageId").compact().map(o).value(),f=a.difference(c,e);a.forEach(f,function(a){b[a].isPopup||d.push(q(b,a))})}function q(a,c){var e=d+b++,f=a[c];return a[e]={id:e,label:f.title,isVisible:!f.hidePage,isVisibleMobile:void 0!==f.mobileHidePage?!f.mobileHidePage:!f.hidePage,items:[],link:h(a,"#"+c),type:"BasicMenuItem",metaData:{}},"#"+e}function r(b,c){var d=a.filter(b,function(a){return a.id&&0===a.id.indexOf(c)}),e=-1;return a.forEach(d,function(a){var b=Number(a.id.replace(c,""));b>e&&(e=b)}),++e}var b=0,c=0,d="bmi",e="pglk",s={exec:function(g,h){if(n(g))return void m(g);var i=g.data.document_data;b=r(i,d),c=r(i,e),g.data.document_data.CUSTOM_MAIN_MENU||(g.data.document_data.CUSTOM_MAIN_MENU={id:"CUSTOM_MAIN_MENU",items:f(g.data.document_data.MAIN_MENU.items,g.data.document_data),name:"Custom Main Menu",type:"CustomMenu",metaData:{}}),g.data.document_data.CUSTOM_MENUS?a.includes(g.data.document_data.CUSTOM_MENUS.menus,"#CUSTOM_MAIN_MENU")||g.data.document_data.CUSTOM_MENUS.menus.push("#CUSTOM_MAIN_MENU"):g.data.document_data.CUSTOM_MENUS={id:"CUSTOM_MENUS",menus:["#CUSTOM_MAIN_MENU"],type:"CustomMenusCollection",metaData:{}},p(i,h),l(i,i.CUSTOM_MAIN_MENU),g.data.document_data.MAIN_MENU.items.length>0&&(g.data.document_data.MAIN_MENU.items=[])}};return s}),define("dataFixer/plugins/sitePagesFixer",["lodash"],function(a){"use strict";function b(b){var c;if(b.structure.children){var d=a.find(b.structure.children,{id:"PAGES_CONTAINER"});d&&!a.isEmpty(d.components)&&(c=a.find(d.components,{id:"SITE_PAGES"}))}return c}function c(b){var c;if(b.structure.mobileComponents){var d=a.find(b.structure.mobileComponents,{id:"PAGES_CONTAINER"});d&&!a.isEmpty(d.components)&&(c=a.find(d.components,{id:"SITE_PAGES"}))}return c}function d(b){a.isEmpty(b.components)||(b.components=[])}function e(a){a.layout&&(a.layout.y=0)}var f={exec:function(a){if(a.structure&&"Document"===a.structure.type){var f=b(a),g=c(a);f&&(d(f),e(f)),g&&(d(g),e(g))}return a}};return f}),define("dataFixer/plugins/linkRefDataFixer",["lodash","coreUtils"],function(a,b){"use strict";var c={exec:function(c){var w,d={toFix:["FlashComponent","SiteButton","Image"],newNames:["LinkableFlashComponent","LinkableButton","Image"],originalLink:["TextLink","Link"]},e=["href","text","target","icon","linkType"],f={oldValues:["same","other"],newValues:["_self","_blank"]},g=function(b){return a.filter(b,function(b){var c=b.type===d.toFix[2],e=!c||"2.0"!==b.metaData.schemaVersion;return!b.link&&a.includes(d.toFix,b.type)&&e},this)},h=function(b){return a.filter(b,function(b){return b.linkType&&a.includes(d.originalLink,b.type)},this)},i=function(b){var c=a.indexOf(d.toFix,b.type),f=d.newNames[c],g=a.defaults({type:f},a.omit(b,e)),h=j(b,!0);return h&&(g.link=p(h.id),v[h.id]=h),b.type===g.type&&(g.metaData.schemaVersion="2.0"),g},j=function(a,b){var c=a.linkType||"",d=c.toLowerCase(),e=b?s():a.id;switch(d){case"page":return l(e,a);case"website":return k(e,a);case"email":return n(e,a);case"document":return m(e,a);case"login":return o(e,a);case"admin_login":return null;case"free_link":return null;case"":return null;default:return null}},k=function(a,b){var c={};c.id=a,c.type="ExternalLink",c.target=q(b.target);var d=b.href;return d?(c.url=d,c):null},l=function(a,b){var c={};c.id=a,c.type="PageLink";var d=b.href;if(!d)return null;var e=d.lastIndexOf("/");return 0>e&&(e=d.lastIndexOf("|")),d=d.substr(e+1),c.pageId=p(d),c},m=function(a,b){var d,e,c={};c.type="DocumentLink",c.id=a;var f=b.href;return f?(d=f.substr(f.lastIndexOf("/")+1),e=d.indexOf("?dn="),-1!==e&&(d=d.substring(0,e)),c.docId=d,c.name=b.text,c):null},n=function(a,c){var d={};d.id=a,d.type="EmailLink";var e=c.href;if(!e||!e.toLowerCase)return null;b.stringUtils.startsWith(e,"mailto:",!0)&&(e=e.substr("mailto:".length));var f=e.split("?");if(d.recipient=f[0],f[1]){var g=r(f[1]);g.subject&&(d.subject=g.subject),g.body&&(d.body=g.body)}return d},o=function(a,c){var d={};d.id=a,d.type="LoginToWixLink";var e=c.text;return e&&b.stringUtils.startsWith(e,"{")&&(e=JSON.parse(e),d.postLoginUrl=e.postLoginUrl,d.postSignupUrl=e.postSignupUrl,d.dialog=e.type),d},p=function(a){return a?a&&b.stringUtils.startsWith(a,"#")?a:"#"+a:null},q=function(b){var c,d=a.indexOf(f.oldValues,b);return c=a.includes(f.newValues,b)?b:-1!==d?f.newValues[d]:f.newValues[1]},r=function(a){for(var d,b={},c=/([^&=]+)=([^&]*)/g;d=c.exec(a);)b[d[1]]=d[2];return b},s=function(){var d,b=a.keys(c.data.document_data);do d=(new Date).getTime().toString(36)+"_"+Math.round(99999*Math.random()).toString(36),d=d.replace(/\s/g,"_");while(b[d]);return d},t=c.data,u=t.document_data,v={};w=g(u),a.forEach(w,function(a){var b=i(a);b&&(u[a.id]=b)},this),w=h(u),a.forEach(w,function(a){var b=j(a);b&&(u[a.id]=b)},this),a.assign(u,v)}};return c}),define("dataFixer/plugins/fromDocumentToThemeData",[],function(){"use strict";var a={exec:function(a){var b=a.data;b.document_data.THEME_DATA&&(b.theme_data.THEME_DATA||(b.theme_data.THEME_DATA=b.document_data.THEME_DATA),delete b.document_data.THEME_DATA)}};return a}),define("dataFixer/plugins/tpaGluedWidgetDataFixer",["lodash"],function(a){"use strict";return{exec:function(b){a.forEach(b.structure.children,function(a){"wysiwyg.viewer.components.tpapps.TPAGluedWidget"===a.componentType&&(a.layout.fixedPosition=!0)})}}}),define("dataFixer/imageService/imageTransformDataFixers",["lodash","imageClientApi"],function(a,b){"use strict";function k(a){return(a||"").toLowerCase().trim()}function l(a){var b=k(a.bgRepeat),c=k(a.bgSize),d=e[b];return f[c]&&f[c](d)}function m(a){return a=k(a),g[a]}function n(a){return h[a]||h[""]}function o(a){return i[a]||i[""]}function p(a){return j[a]||j[""]}function q(a){return a===c.TILE?c.LEGACY_STRIP_TILE:a===c.TILE_HORIZONTAL?c.LEGACY_STRIP_TILE_HORIZONTAL:a===c.TILE_VERTICAL?c.LEGACY_STRIP_TILE_VERTICAL:a===c.SCALE_TO_FILL?c.LEGACY_STRIP_SCALE_TO_FILL:a===c.SCALE_TO_FIT?c.LEGACY_STRIP_SCALE_TO_FIT:a===c.FIT_AND_TILE?c.LEGACY_STRIP_FIT_AND_TILE:a===c.LEGACY_ORIGINAL_SIZE?c.LEGACY_STRIP_ORIGINAL_SIZE:a}var c=b.fittingTypes,d=b.alignTypes,e={"repeat-x":c.TILE_HORIZONTAL,"repeat no_repeat":c.TILE_HORIZONTAL,"repeat no-repeat":c.TILE_HORIZONTAL,"repeat-y":c.TILE_VERTICAL,"no_repeat repeat":c.TILE_VERTICAL,"no-repeat repeat":c.TILE_VERTICAL,repeat:c.TILE,"repeat repeat":c.TILE,"":""},f={auto:function(a){return a?a:c.LEGACY_ORIGINAL_SIZE},cover:function(){return c.SCALE_TO_FILL},contain:function(a){return a?c.FIT_AND_TILE:c.SCALE_TO_FIT},"":function(){return c.SCALE_TO_FILL}},g={"center center":d.CENTER,center:d.CENTER,"50% 50%":d.CENTER,"top center":d.TOP,"center top":d.TOP,"50% 0%":d.TOP,"bottom center":d.BOTTOM,"center bottom":d.BOTTOM,"50% 100%":d.BOTTOM,"center right":d.RIGHT,"right center":d.RIGHT,"100% 50%":d.RIGHT,"center left":d.LEFT,"left center":d.LEFT,"0% 50%":d.LEFT,"left top":d.TOP_LEFT,"top left":d.TOP_LEFT,"0% 0%":d.TOP_LEFT,"right top":d.TOP_RIGHT,"top right":d.TOP_RIGHT,"100% 0%":d.TOP_RIGHT,"left bottom":d.BOTTOM_LEFT,"bottom left":d.BOTTOM_LEFT,"0% 100%":d.BOTTOM_LEFT,"right bottom":d.BOTTOM_RIGHT,"bottom right":d.BOTTOM_RIGHT,"100% 100%":d.BOTTOM_RIGHT,"":d.CENTER},h=function(){var a={};return a[c.LEGACY_STRIP_TILE_HORIZONTAL]="repeat-x",a[c.TILE_HORIZONTAL]="repeat-x",a[c.LEGACY_STRIP_TILE_VERTICAL]="repeat-y",a[c.TILE_VERTICAL]="repeat-y",a[c.LEGACY_STRIP_TILE]="repeat",a[c.TILE]="repeat",a[c.FIT_AND_TILE]="repeat",a[""]="no-repeat",a}(),i=function(){var a={};return a[c.LEGACY_ORIGINAL_SIZE]="auto",a[c.LEGACY_STRIP_ORIGINAL_SIZE]="auto",a[c.SCALE_TO_FILL]="cover",a[c.LEGACY_STRIP_SCALE_TO_FILL]="cover",a[c.SCALE_TO_FIT]="contain",a[c.LEGACY_STRIP_SCALE_TO_FIT]="contain",a[c.FIT_AND_TILE]="contain",a[c.LEGACY_STRIP_FIT_AND_TILE]="contain",a[""]="auto",a}(),j=function(){var a={};return a[d.TOP]="center top",a[d.CENTER]="center",a[d.BOTTOM]="center bottom",a[d.TOP_LEFT]="left top",a[d.LEFT]="left center",a[d.BOTTOM_LEFT]="left bottom",a[d.TOP_RIGHT]="right top",a[d.RIGHT]="right center",a[d.BOTTOM_RIGHT]="right bottom",a[""]="center",a}();return{cssToFittingType:l,cssToAlignType:m,fittingTypeToBgRepeat:n,fittingTypeToBgSize:o,alignTypeToBgPosition:p,migrateToLegacyFittings:q}}),define("dataFixer/plugins/compsWithImagesDataFixer",["lodash","dataFixer/imageService/imageTransformDataFixers"],function(a,b){"use strict";function d(b){a.forEach(b,function(a){var b=c[a.type];b&&b(a)})}function e(b){a.noop(b)}var c={BgImageStripProperties:function(a){a.fittingType=b.cssToFittingType({bgSize:a.bgSize,bgRepeat:a.bgRepeat}),a.fittingType=b.migrateToLegacyFittings(a.fittingType),a.alignType=b.cssToAlignType(a.bgPosition),a.type="BgImageStripUnifiedProperties",delete a.bgSize,delete a.bgRepeat,delete a.bgPosition,delete a.bgUrl}},f={exec:function(b){var c=b.data.component_properties,f=b.data.document_data;a.isEmpty(c)||d(c),a.isEmpty(f)||e(f)}};return f}),define("dataFixer/plugins/appPartCustomizationsFixer",["lodash"],function(a){"use strict";function c(c){a(b).values().forEach(function(b){a(c.data.document_data).filter(b.filterAppPart).forEach(function(c){c.appLogicCustomizations=a(c.appLogicCustomizations).map(function(c){var d=a.find([c],b.filterAppLogicCustomization);return d?b.modify(c):c}).compact().value()}).value()}).value()}var b={faq:{filterAppPart:{appPartName:"f2c4fc13-e24d-4e99-aadf-4cff71092b88",viewName:"ExpandQuestions"},filterAppLogicCustomization:{type:"AppPartCustomization",forType:"Category",view:"ToggleMobile",key:"comp.initialState",fieldId:"toggle",format:"Mobile"},modify:function(b){return a.assign(b,{fieldId:"vars",key:"initialState"})}}};return{exec:c}}),define("dataFixer/plugins/backgroundMediaConverter",["lodash","imageClientApi","dataFixer/imageService/imageTransformDataFixers","coreUtils"],function(a,b,c,d){"use strict";function j(b,c){var d=a.filter(b,function(a){return"Page"===a.type||"AppPage"===a.type}),e=a.map(d,"id"),f=a.some(d,function(a){return a.pageBackgrounds&&a.pageBackgrounds.desktop.ref});if(f)l(b);else{var g=c.siteBg,h=c.mobileBg&&"[siteBg]"!==c.mobileBg?c.mobileBg:c.siteBg;o(b,g,h,e)}}function k(a){l(a)}function l(b){var c=a.filter(b,{type:f});a.forEach(c,function(a){m(b,a)})}function m(a,b){var c=b.id,e=d.guidUtils.getUniqueId(g+i),f=r(b);n(a,f,c,e)}function n(b,c,d,e){b[d]=a.assign({id:d},c.bgItem),c.imageItem&&(b[d].mediaRef="#"+e,b[e]=a.assign({id:e},c.imageItem))}function o(b,c,e,f){var j=q(c),k=q(e);a.forEach(f,function(a){var c=d.guidUtils.getUniqueId(h,i),e=d.guidUtils.getUniqueId(h,i),f=c.replace(h,g),l=e.replace(h,g);p(b,j,a,c,f,"desktop"),p(b,k,a,e,l,"mobile")})}function p(a,b,c,d,e,f){a[c].pageBackgrounds=a[c].pageBackgrounds||{desktop:"",mobile:""},a[c].pageBackgrounds[f]={ref:"#"+d,custom:!0,isPreset:!1},n(a,b,d,e)}function q(b){var c=s.apply(this,a.compact(b.split(" ")));return t(c)}function r(a){var b=s.apply(this,[a.url,a.imagesizew,a.imagesizeh,a.positionx,a.positiony,a.width,a.repeatx,a.repeaty,a.attachment,a.color,a.metaData]);return t(b)}function s(a,b,c,d,e,f,g,h,i,j,k){return k=k||{},{imageId:a,imageW:b,imageH:c,x:d,y:e,width:f,repeatX:g,repeatY:h,attachment:i,color:j,metaData:{isPreset:k.isPreset||!1,schemaVersion:"2.0",isHidden:k.isHidden||!1}}}function t(a){var b={bgItem:{}},d="rgb(255,255,255)",e=c.cssToAlignType(a.x+" "+a.y),f=c.cssToFittingType({bgRepeat:a.repeatX+" "+a.repeatY,bgSize:a.width}),g="fixed"===a.attachment?"fixed":"scroll";return f=u(f),a.color&&"none"!==a.color&&(d=a.color),a.imageId&&"none"!==a.imageId&&(b.imageItem={type:"Image",uri:a.imageId,width:parseInt(a.imageW,10),height:parseInt(a.imageH,10),metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}}),b.bgItem={type:"BackgroundMedia",color:d,alignType:e,fittingType:f,scrollType:g,metaData:a.metaData},b}function u(a){var c={};return c[b.fittingTypes.TILE]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE,c[b.fittingTypes.TILE_HORIZONTAL]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,c[b.fittingTypes.TILE_VERTICAL]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,c[b.fittingTypes.LEGACY_ORIGINAL_SIZE]=b.fittingTypes.LEGACY_BG_NORMAL,c[a]||a}function v(a){a.siteBg=w(a.siteBg),a.mobileBg&&"[siteBg]"!==a.mobileBg&&(a.mobileBg=w(a.mobileBg))}function w(b){var c=a.compact(b.split(" ")),d=s.apply(this,c),e=d.color;return e&&(e=e.replace("[","{"),e=e.replace("]","}"),c[9]=e),c.join(" ")}var e="BackgroundMedia",f="BackgroundImage",g="bgImage",h="mediaBg",i="-",x={exec:function(b){if(b.structure){var c=b.data.theme_data&&b.data.theme_data.THEME_DATA,d=b.data.document_data,g=a.some(d,{type:e}),h=a.some(d,{type:f});g&&!h||("Document"===b.structure.type?(v(c),j(d,c)):k(d))}}};return x}),define("dataFixer/plugins/backgroundMediaUndefinedFixer",["lodash","coreUtils"],function(a,b){"use strict";function f(a,c){return b.guidUtils.getUniqueId(c.id,"_")+a}function g(b,c){c[b]=a.assign({id:b},d)}function h(b){var c=a.filter(b,function(a){return"Page"===a.type||"AppPage"===a.type});a.forEach(c,function(c){var d;a.defaults(c,e),c.pageBackgrounds.mobile.ref||(d=f("_mobile_bg",c),g(d,b),c.pageBackgrounds.mobile.ref="#"+d),c.pageBackgrounds.desktop.ref||(d=f("_desktop_bg",c),g(d,b),c.pageBackgrounds.desktop.ref="#"+d)})}var c="BackgroundMedia",d={alignType:"center",color:"{color_11}",fittingType:"fill",scrollType:"scroll",type:"BackgroundMedia"},e={pageBackgrounds:{desktop:{custom:!0,isPreset:!0,ref:null},mobile:{custom:!0,isPreset:!0,ref:null}}},i={exec:function(b){if(b.structure){var d=b.data.document_data,e=a.some(d,{type:c});e&&h(d)}}};return i}),define("dataFixer/plugins/backgroundMediaRefDuplicationFixer",["lodash"],function(a){"use strict";function b(b,c,d){d[b]=a.assign({id:b},a.omit(c,"id"))}function c(a,b,c){return a+"_"+b+"_"+c}function d(d,e,f,g,h){if(0!==d[e].indexOf("#"+g)){var i=a.cloneDeep(h[d[e].replace("#","")]),j=c(g,f,e);b(j,i,h),d[e]="#"+j}}function e(a,b,c){var g,e=b.pageBackgrounds[a].ref.replace("#",""),f=c[e];f&&f.mediaRef&&(g=c[f.mediaRef.replace("#","")],"WixVideo"===g.type&&d(g,"posterImageRef",a,b.id,c),f.imageOverlay&&d(f,"imageOverlay",a,b.id,c),d(f,"mediaRef",a,b.id,c))}function f(a,b){a.pageBackgrounds&&(e("mobile",a,b),e("desktop",a,b))}var g={exec:function(b){if(b.structure){var c=b.data.document_data,d=a.filter(c,function(a){return"Page"===a.type||"AppPage"===a.type});a.forEach(d,function(a){f(a,c)})}}};return g}),define("dataFixer/plugins/stripContainerBgEffectFixer",["lodash","dataFixer/helpers/behaviorsMigrationHelper"],function(a,b){"use strict";function e(b,c){var d=a.get(c,[b.behaviorQuery,"items"],"[]");return JSON.parse(d)}function f(a,b){var c,d;return d=a.designQuery.replace("#",""),c=b[d].background.replace("#",""),b[c]}function g(g,h,i){var j,k;if(a.includes(c,g.componentType)){var l=f(g,h);if(k=l.scrollType,l.scrollType="none","scroll"!==k&&"none"!==k){j=e(g,i),j=a.reject(j,{name:"ContainerFixedBg",action:"bgScrub"}),j.push(d[k]);var m=JSON.stringify(j);if(g.behaviorQuery)a.set(i,[g.behaviorQuery,"items"],m);else{var n=b.createBehaviorsDataItem(m);a.set(i,n.id,n),g.behaviorQuery=n.id}}}}function h(b,d,g){var h;if(a.includes(c,b.componentType)){var i=f(b,d);i.scrollType="none",h=e(b,g),h=a.reject(h,{name:"ContainerFixedBg",action:"bgScrub"}),a.isEmpty(h)?(delete b.behaviors,delete b.behaviorQuery):a.set(g,[b.behaviorQuery,"items"],JSON.stringify(h))}}function i(b,c,d){a.forEach(b,function(a){g(a,c,d),a.components&&i(a.components,c,d)})}function j(b,c,d){a.forEach(b,function(a){h(a,c,d),a.components&&j(a.components,c,d)})}var c=["wysiwyg.viewer.components.StripContainer","wysiwyg.viewer.components.StripContainerSlideShowSlide"],d={fixed:{action:"bgScrub",name:"BackgroundReveal",duration:1,delay:0},parallax:{action:"bgScrub",name:"BackgroundParallax",duration:1,delay:0}},k={exec:function(a){var c,b=a.structure;if(b){c=a.data.design_data;var d=a.data.behaviors_data;b.components&&i(b.components,c,d),b.children&&i(b.children,c,d),b.mobileComponents&&j(b.mobileComponents,c,d)}}};return k}),define("dataFixer/plugins/documentMediaFixer",["lodash"],function(a){"use strict";var b={exec:function(b){if("Page"===b.structure.type){var c=b.structure.components,d=b.data.document_data;a.forEach(c,function(b){if(a.includes(b.componentType,"DocumentMedia")){var c=b.dataQuery,e=d[c.replace("#","")];0===e.uri.indexOf("media/")&&(e.uri=e.uri.replace("media/",""))}})}return b}};return b}),define("dataFixer/plugins/pinterestFollowFixer",["lodash"],function(a){"use strict";var b=function(b){var c="www.pinterest.com/";b.urlChoice=a.includes(b.urlChoice,"pinterest.com")?b.urlChoice:c+b.urlChoice},c={exec:function(c){return a(c.data.document_data).pick(function(a){return"PinterestFollow"===a.type}).mapValues(b).value()}};return c}),define("dataFixer/plugins/blogPageMenuFixer",["lodash"],function(a){"use strict";function b(a){var b=c(a);b&&d(a,"#"+b)}function c(b){var c=a.findKey(b,function(a){return a.appPageId&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===a.appPageId});if(!c)return null;var d=a.findKey(b,function(a){return a.pageId&&a.pageId==="#"+c});return a.findKey(b,function(a){return a.link&&a.link==="#"+d})}function d(b,c){var d=b.CUSTOM_MAIN_MENU&&b.CUSTOM_MAIN_MENU.items;a.forEach(d,function(d){var e=b[d.replace("#","")].items,f=a.indexOf(e,c);return-1!==f?(e.splice(f,1),b.CUSTOM_MAIN_MENU.items.push(c),!1):void 0})}var e={exec:function(a){return a.structure&&"Document"===a.structure.type&&b(a.data.document_data),a}};return e}),define("dataFixer/plugins/appPartMediaInnerCustomizationFormatFixer",["lodash","coreUtils"],function(a,b){"use strict";var c={exec:function(d){d.data&&d.data.document_data&&a(d.data.document_data).filter(function(a){return c.isAppPartType(a.type)}).forEach(function(c){a(c.appLogicCustomizations).compact().groupBy("view").filter(function(a,c){return b.appPartMediaInnerViewNameUtils.isMediaInnerViewName(c)}).forEach(function(b){a(b).groupBy("fieldId").filter(function(b){return a.isEqual(a.pluck(b,"format"),[""])}).forEach(function(b){a.forEach(b,function(a){a.format="*"})}).value()}).value()}).value()},isAppPartType:function(a){return"AppPart"===a}};return c}),define("dataFixer/plugins/appPartReadMoreValueCustomizationFormatFixer",["lodash","coreUtils"],function(a,b){"use strict";var c={exec:function(b){b.data&&a(b.data.document_data).filter(function(b){return b.type===c.getAppPartType()&&a.includes(c.getBlogFeedAppPartNames(),b.appPartName)}).forEach(function(b){var d=b.appLogicCustomizations;a(d).compact().filter(function(b){return b.fieldId===c.getReadMoreValueCustomizationFieldId()&&b.key===c.getReadMoreValueCustomizationKey()&&""===b.format&&a.includes(c.getAffectedReadMoreValueCustomizationViews(),b.view)}).forEach(function(b){a.remove(d,{fieldId:b.fieldId,format:"*",key:b.key,view:b.view}),b.format="*"}).value()}).value()},getAppPartType:function(){return"AppPart"},getBlogFeedAppPartNames:function(){return[b.blogAppPartNames.FEED,b.blogAppPartNames.CUSTOM_FEED]},getReadMoreValueCustomizationFieldId:function(){return"ReadMoreBtn"},getReadMoreValueCustomizationKey:function(){return"value"},getAffectedReadMoreValueCustomizationViews:function(){return["MediaLeft","MediaLeftPage","MediaRight","MediaRightPage","MediaZigzag","MediaZigzagPage","Masonry","MasonryPage"]}};return c}),define("dataFixer/plugins/appPartTagsValueCustomizationFormatFixer",["lodash"],function(a){"use strict";return{exec:function(b){a(b.data.document_data).filter({type:"AppPart"}).forEach(function(b){a(b.appLogicCustomizations).filter({fieldId:"tagsValue",forType:"Post",format:"",key:"value",view:"SinglePostMediaTop"}).forEach(function(a){a.format="*"}).value()}).value()}}}),define("dataFixer/plugins/appPartDuplicateCustomizationFixer",["lodash"],function(a){"use strict";function b(b){var c=a.omit(b,"value");return JSON.stringify(c)}return{exec:function(c){a(c.data.document_data).filter({type:"AppPart"}).forEach(function(a){for(var c=a.appLogicCustomizations,d=c.length,e={};d;){d-=1;var f=b(c[d]);e[f]?c.splice(d,1):e[f]=!0}}).value()}}}),define("dataFixer/plugins/blogCustomFeedPostsPerPageCustomizationFixer",["lodash","coreUtils"],function(a,b){"use strict";function c(b){return"Array"===b.forType&&"comp.itemsPerPage"===b.key&&a.includes(["","*"],b.format)&&a.includes(["paginatedlist","columnBlog"],b.fieldId)&&a.includes(["MediaTop","MediaBottom","MediaLeft","MediaRight","MediaZigzag","Masonry"],b.view)}return{exec:function(d){a(d.data.document_data).filter({type:"AppPart",appPartName:b.blogAppPartNames.CUSTOM_FEED}).forEach(function(b){a(b.appLogicCustomizations).filter(c).forEach(function(b){a.assign(b,{fieldId:"vars",format:"*",key:"itemsPerPage"})}).value()}).value()}}}),define("dataFixer/plugins/blogDateAlignmentCustomizationFixer",["lodash","coreUtils"],function(a,b){"use strict";function c(b){return"Post"===b.forType&&"layout.spacerBefore"===b.key&&"date"===b.fieldId&&a.includes(["MediaTop","MediaBottom","MediaLeft","MediaRight","MediaZigzag","Masonry","MediaTopPage","MediaBottomPage","MediaLeftPage","MediaRightPage","MediaZigzagPage","MasonryPage","SinglePostMediaBottom","SinglePostMediaTop"],b.view)}return{exec:function(d){a(d.data.document_data).filter(function(c){return"AppPart"===c.type&&a.includes([b.blogAppPartNames.CUSTOM_FEED,b.blogAppPartNames.FEED,b.blogAppPartNames.SINGLE_POST],c.appPartName)}).forEach(function(b){a(b.appLogicCustomizations).filter(c).forEach(function(b){a.assign(b,{fieldId:"vars",key:"dateAndAuthorPosition",value:"0"===b.value?"left":"right"})}).value()}).value()}}}),define("dataFixer/plugins/appPartBrokenButtonStyleFixer",["lodash","coreUtils"],function(a,b){"use strict";var c=null;return{exec:function(d){a.isNull(c)&&(c=[],a.forEach(d.data.theme_data,function(b,d,e){var f=a.matches({componentClassName:"wysiwyg.viewer.components.SiteButton",skin:"wysiwyg.viewer.skins.AppPartSkin"})(b);f&&(c.push(d),delete e[d])}),setTimeout(function(){c=null})),a(d.data.document_data).filter(function(c){return"AppPart"===c.type&&a.includes(b.blogAppPartNames,c.appPartName)}).forEach(function(b){a.remove(b.appLogicCustomizations,function(b){return"comp.style"===b.key&&a.includes(c,b.value)})}).value()}}}),define("dataFixer/plugins/blogDateFormatCustomizationFormatFixer",["lodash","coreUtils"],function(a,b){"use strict";var c={};return c[b.blogAppPartNames.FEED]=["MediaBottomPage","MediaLeftPage","MediaRightPage","MediaTopPage","MediaZigzagPage"],c[b.blogAppPartNames.POSTS_LIST]=["PostsList","PostsListMediaLeft"],c[b.blogAppPartNames.TICKER]=["TickerMediaBottom","TickerMediaTop"],{exec:function(d){a(d.data.document_data).filter(function(c){return"AppPart"===c.type&&a.includes([b.blogAppPartNames.FEED,b.blogAppPartNames.POSTS_LIST,b.blogAppPartNames.TICKER],c.appPartName)}).forEach(function(b){a(b.appLogicCustomizations).filter(function(d){return"date"===d.fieldId&&"Post"===d.forType&&!d.format&&"comp.format"===d.key&&a.includes(c[b.appPartName],d.view)}).forEach(function(a){a.format="*"}).value()}).value()}}}),define("dataFixer/plugins/contactFormDataFixer",["lodash","coreUtils","translationsUtils"],function(a,b,c){"use strict";function e(){return"Template"===a.get("undefined"!=typeof window&&window,"rendererModel.siteInfo.documentType")}function f(f,g,h){var i,j;e()&&(i=b.wixUserApi.getLanguage(g.cookie,h),j=c.contactFormTranslations[i],j&&a.forOwn(f,function(b){"ContactForm"===b.type&&a.forEach(d,function(a){b[a]=j[a]||b[a]})}))}function g(b){a.forOwn(b,function(a){"ContactForm"===a.type&&(a.onSubmitBehavior||(a.onSubmitBehavior="message"))})}var d=["addressFieldLabel","emailFieldLabel","errorMessage","messageFieldLabel","nameFieldLabel","phoneFieldLabel","subjectFieldLabel","submitButtonLabel","successMessage","validationErrorMessage"],h={exec:function(a,b,c,d){var e=a.data.document_data;f(e,c,d),g(e)}};return h}),define("dataFixer/plugins/subscribeFormDataFixer",["lodash","coreUtils","translationsUtils"],function(a,b,c){"use strict";function e(){return"Template"===a.get("undefined"!=typeof window&&window,"rendererModel.siteInfo.documentType")}function f(f,g,h){var i,j;e()&&(i=b.wixUserApi.getLanguage(g.cookie,h),j=c.subscribeFormTranslations[i],j&&a.forOwn(f,function(b){"SubscribeForm"===b.type&&a.forEach(d,function(a){b[a]=j[a]||b[a]})}))}function g(b){a.forOwn(b,function(a){"SubscribeForm"===a.type&&(a.onSubmitBehavior||(a.onSubmitBehavior="message"))})}var d=["emailFieldLabel","errorMessage","firstNameFieldLabel","lastNameFieldLabel","phoneFieldLabel","submitButtonLabel","subscribeFormTitle","successMessage","validationErrorMessage"],h={exec:function(a,b,c,d){var e=a.data.document_data;f(e,c,d),g(e)}};return h}),define("dataFixer/plugins/pageDataFixer",["lodash"],function(a){"use strict";function b(b){return"Page"===a.get(b,"structure.type")}function c(b){a(b.data.document_data).where({type:"Page"}).pluck("id").forEach(function(a){delete b.data.document_data[a]}).value()}function d(b){a.forEach(b.data.document_data,function(a){"#SITE_STRUCTURE"===a.pageId&&(a.pageId="#masterPage")})}function e(a){b(a)&&c(a),d(a)}return{exec:e}}),define("dataFixer/plugins/groupFixer",["lodash"],function(a){"use strict";function d(a){a.componentType===b&&(a.skin=c)}function e(b){a.forEach(b,function(a){d(a),e(a.components)})}var b="wysiwyg.viewer.components.Group",c="wysiwyg.viewer.components.GroupSkin",f={exec:function(a){var b=a.structure;if(b){var c=b.components||b.children,d=b.mobileComponents;c&&e(c),d&&e(d)}}};return f}),define("dataFixer/plugins/textSecurityFixer",["lodash"],function(a){"use strict";function c(c){return a(c).pick(function(c){return a.includes(b,c.type)}).mapValues(function(a){return a.text=d(a.text),a.text=e(a.text),
a}).value()}function d(a){return a&&a.replace(/(<object[^>]*>)(.*?)(<\/object>)/gi,"")}function e(a){return a&&a.replace(/<img[^>]*(onerror|onload|onmouseenter|onmousemove|onmouseleave|onmouseover|onmouseup|onmouseout)[^>]*\/?>(<\/img>)?/gi,"")}var b=["RichText","Text","StyledText","MediaRichText"],f={exec:function(a){var b=a.data.document_data;b&&c(b)}};return f}),define("dataFixer/plugins/pageUriSeoFixer",["lodash","coreUtils"],function(a,b){"use strict";var c=a.matchesProperty(["structure","type"],"Page"),d=a.matchesProperty("format",b.siteConstants.URL_FORMATS.SLASH);return{exec:function(b,e,f,g,h){d(h)&&!c(b)&&a.forEach(h.pageIdToResolvedUriSEO,function(a,c){b.data.document_data[c].pageUriSEO=a.curr})}}}),define("dataFixer/helpers/shouldRunStripToColumnMigration",[],function(){"use strict";var a="Editor1.4";return function(b,c){var d=b===a;return c||d}}),define("dataFixer/plugins/migrateStripToColumnsContainer",["lodash","dataFixer/helpers/CompsMigrationHelper","dataFixer/helpers/shouldRunStripToColumnMigration","coreUtils"],function(a,b,c,d){"use strict";function e(){return{type:"MediaContainerDesignData",id:d.guidUtils.getUniqueId("dataItem","-"),background:{id:d.guidUtils.getUniqueId("dataItem","-"),type:"BackgroundMedia",mediaRef:null,alignType:"center",fittingType:"fill",colorOpacity:0,colorOverlay:"",colorOverlayOpacity:1,imageOverlay:"",scrollType:"none",color:"#FFFFFF"}}}function f(){return{columnsMargin:0,frameMargin:0,fullWidth:!0,rowMargin:0,siteMargin:0,type:"StripColumnsContainerProperties"}}function g(){return{type:"ColumnProperties",alignment:50}}function h(b,c){return{id:a.get(c,[b.id,"mediaId"],d.guidUtils.getUniqueId("media")),type:"Container",layout:{width:b.layout.width,height:b.layout.height,x:0,y:0,scale:1,rotationInDegrees:0,anchors:[{distance:0,topToTop:0,originalValue:0,type:"BOTTOM_PARENT",locked:!0,targetComponent:b.id}],fixedPosition:!1},components:b.components,componentType:"wysiwyg.viewer.components.Column",styleId:"strc1"}}function i(b,c){a.forEach(b.components,function(b){var d=a.get(b,["layout","anchors"],[]);a.forEach(d,function(a){"BOTTOM_PARENT"===a.type&&(a.targetComponent=c.id)})})}function j(b,c){b.behaviors&&(c.behaviors=a.clone(b.behaviors),delete b.behaviors),b.behaviorQuery&&(c.behaviorQuery=b.behaviorQuery,delete b.behaviorQuery)}function k(b,c,d,k){k.componentType="wysiwyg.viewer.components.StripColumnsContainer",delete k.skin,k.styleId="strc1",this.setComponentProperties(b,k,f(),c);var l=h(k,c);if(i(k,l),j(k,l),a.set(c,[k.id,"mediaId"],l.id),this.setComponentProperties(b,l,g(),c),l.designQuery=k.designQuery,delete k.designQuery,d)k.layout.width=320,k.designQuery=a.get(c,[k.id,"designQuery"]),this.deleteComponentData(b,k);else{k.layout.width=980;var m=e();this.setComponentDesignData(b,k,m,c)}delete k.dataQuery,k.components=[l]}var l={"wysiwyg.viewer.components.StripContainer":k},m=new b(l),n={exec:function(b,d,e,f,g,h){var i=a.get(f,"query.dsOrigin","");c(i,h)&&m.migratePage.apply(m,arguments)}};return n}),define("dataFixer/plugins/tinyMenuSkinBackgroundFixer",["lodash"],function(a){"use strict";function c(c){function g(b,c,d){a.isUndefined(b)||a.isUndefined(b[c])||(b[d]=b[d]||b[c])}if(c.skin===b&&!a.isUndefined(c.style)&&!a.isUndefined(c.style.properties)){var d=[["bg","bgDrop"],["bg","bgOpen"],["txt","bordercolor"],["txt","iconcolor"],["bordercolor","borderColorSelected"]],e=c.style.properties,f=c.style.propertiesSource;a.forEach(d,function(a){var b=a[0],c=a[1];g(e,b,c),g(f,b,c),b="alpha-"+b,c="alpha-"+c,g(e,b,c),g(f,b,c)})}}var b="wysiwyg.viewer.skins.mobile.TinyMenuSkin",d={exec:function(b){var d=b.data&&b.data.theme_data;a.isEmpty(d)||a.forEach(d,c)}};return d}),define("dataFixer/plugins/designDataFixer",["lodash","coreUtils"],function(a,b){"use strict";function c(a){return"wysiwyg.viewer.components.StripContainer"===a.componentType}function d(b){return!a.isUndefined(b.designQuery)}function e(c,d,e){return a.isUndefined(e)&&(e=b.guidUtils.getUniqueId("dataItem","-")),d[e]={id:e,type:"MediaContainerDesignData",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}},c.designQuery="#"+e,e}function f(a,b,c){return b[c]=a[c],delete a[c],b[c]}function g(b,c,d,e){var g=d[b];if(!a.isUndefined(g.background)){var h=g.background.slice(1),i=f(d,e,h);if(!a.isUndefined(i.mediaRef)){var j=i.mediaRef.slice(1),k=f(d,e,j);if("WixVideo"===k.type){var l=k.posterImageRef.slice(1);f(d,e,l)}if(!a.isUndefined(k.originalImageDataRef)){var m=k.originalImageDataRef.slice(1);f(d,e,m)}a.isUndefined(k.link)||delete k.link}if(!a.isUndefined(i.imageOverlay)){var n=i.imageOverlay.slice(1);f(d,e,n)}return delete g.background,e[c].background="#"+h,h}}function h(b,c,d,f,h){var i=h.dataQuery.slice(1),j=e(h,c);d[i]=j;var k=g(i,j,b,c);a.isUndefined(k)||(f[i]=k)}function i(b,c,d,f){var g=f.dataQuery.slice(1),h=d[g],i="mobile_"+c[g];e(f,b,i),a.isUndefined(h)||(b[i].background="#"+h)}function j(b,e,f,g){var j={},k={},l=a.filter(b,c);a(l).reject(d).forEach(a.partial(h,f,g,k,j)).value(),a(e).filter(function(a){return c(a)&&!d(a)}).forEach(a.partial(i,g,k,j)).value()}function k(b){return a.isUndefined(b.components)?a.isUndefined(b.children)?[]:b.children:b.components}function l(b){for(var c=a.clone(b)||[],d=[];c.length>0;){var e=c.pop();d.push(e);var f=k(e);a.forEach(f,function(a){c.push(a)})}return d}function m(a){return l(k(a.structure))}function n(a){return l(a.structure.mobileComponents)}return{exec:function(a){var b=m(a),c=n(a);a.data.design_data=a.data.design_data||{},j(b,c,a.data.document_data,a.data.design_data)}}}),define("dataFixer/plugins/homePageLoginDataFixer",["lodash"],function(a){"use strict";function b(a){a.metaData&&"2.0"===a.metaData.schemaVersion||(a.sendMail=!0)}function c(c){a.forEach(c,function(a){"LoginToWixLink"!==a.type&&"HomePageLogin"!==a.type||b(a)})}var d={exec:function(b){var d=b.data.document_data;a.isEmpty(d)||c(d)}};return d}),define("dataFixer/plugins/characterSetsFixer",["lodash"],function(a){"use strict";var b={exec:function(b){return b.structure&&"Document"===b.structure.type&&a.isEmpty(b.data.document_data.masterPage.characterSets)&&(b.data.document_data.masterPage.characterSets=["latin"]),b}};return b}),define("dataFixer/plugins/popupPropsTempDataFixer",["lodash"],function(a){"use strict";return{exec:function(b){var c=a.get(b,["data","component_properties",b.structure.id]),d=c&&c.popup;d&&(a.forEach(["desktop","mobile"],function(b){var d=c[b],e=c.popup[b];(d||e)&&a.set(c,[b,["popup"]],a.assign(d||{},e||{}))}),delete c.popup)}}}),define("dataFixer/plugins/blogSelectionSharerCustomizationsFixer",["lodash","coreUtils"],function(a,b){"use strict";return{exec:function(c){a(c.data.document_data).filter({type:"AppPart",appPartName:b.blogAppPartNames.SINGLE_POST}).forEach(function(b){var c=a.find(b.appLogicCustomizations,{forType:"Post",fieldId:"vars",key:"selectionSharerExperimentOpen",view:b.viewName});c||(c={forType:"Post",fieldId:"vars",key:"selectionSharerExperimentOpen",view:b.viewName,type:"AppPartCustomization",format:""},b.appLogicCustomizations.push(c))}).value()}}}),define("dataFixer/plugins/boxSlideShowDataFixer",["lodash","coreUtils","translationsUtils"],function(a,b,c){"use strict";function e(){return"Template"===a.get("undefined"!=typeof window&&window,"rendererModel.siteInfo.documentType")}function f(f,g,h){var i,j;e()&&(i=g?b.wixUserApi.getLanguage(g.cookie,h):"en",j=c.boxSlideShowTranslation[i],j&&a.forOwn(f,function(a){if("boxSlideShowSlide"===a.type||"StripContainerSlideShowSlide"===a.type){var b=a.title?a.title.split(" ")[1]:"";a.title=j[d]&&b?j[d].replace("<%= curr_slide %>",b):a.title}}))}var d="BOXSLIDESHOW_Regular_Slideshow_Slides_New_Slide_Label",g={exec:function(a,b,c,d){var e=a.data.document_data;f(e,c,d)}};return g}),define("dataFixer/core/fixPageData",["lodash","experiment","loggingUtils","dataFixer/plugins/galleriesMobileTypeFixer","dataFixer/plugins/pageTopFixer","dataFixer/plugins/masterPageFixer","dataFixer/plugins/menuFixer","dataFixer/plugins/verticalMenuFixer","dataFixer/plugins/skinFixer","dataFixer/plugins/stylesFixer","dataFixer/plugins/bgImageStripDataFixer","dataFixer/plugins/compFixer","dataFixer/plugins/galleryFixer","dataFixer/plugins/behaviorsFixer","dataFixer/plugins/connectionsDataFixer","dataFixer/plugins/fiveGridLineLayoutFixer","dataFixer/plugins/toPageAnchorsFixer","dataFixer/plugins/wrongAnchorsFixer","dataFixer/plugins/addMissingAnchorsOfMasterPage","dataFixer/plugins/customSiteMenuFixer","dataFixer/plugins/sitePagesFixer","dataFixer/plugins/linkRefDataFixer","dataFixer/plugins/fromDocumentToThemeData","dataFixer/plugins/tpaGluedWidgetDataFixer","dataFixer/plugins/compsWithImagesDataFixer","dataFixer/plugins/appPartCustomizationsFixer","dataFixer/plugins/backgroundMediaConverter","dataFixer/plugins/backgroundMediaUndefinedFixer","dataFixer/plugins/backgroundMediaRefDuplicationFixer","dataFixer/plugins/stripContainerBgEffectFixer","dataFixer/plugins/documentMediaFixer","dataFixer/plugins/pinterestFollowFixer","dataFixer/plugins/blogPageMenuFixer","dataFixer/plugins/appPartMediaInnerCustomizationFormatFixer","dataFixer/plugins/appPartReadMoreValueCustomizationFormatFixer","dataFixer/plugins/appPartTagsValueCustomizationFormatFixer","dataFixer/plugins/appPartDuplicateCustomizationFixer","dataFixer/plugins/blogCustomFeedPostsPerPageCustomizationFixer","dataFixer/plugins/blogDateAlignmentCustomizationFixer","dataFixer/plugins/appPartBrokenButtonStyleFixer","dataFixer/plugins/blogDateFormatCustomizationFormatFixer","dataFixer/plugins/contactFormDataFixer","dataFixer/plugins/subscribeFormDataFixer","dataFixer/plugins/pageDataFixer","dataFixer/plugins/groupFixer","dataFixer/plugins/textSecurityFixer","dataFixer/plugins/pageUriSeoFixer","dataFixer/plugins/migrateStripToColumnsContainer","dataFixer/plugins/tinyMenuSkinBackgroundFixer","dataFixer/plugins/designDataFixer","dataFixer/plugins/homePageLoginDataFixer","dataFixer/plugins/characterSetsFixer","dataFixer/plugins/popupPropsTempDataFixer","dataFixer/plugins/blogSelectionSharerCustomizationsFixer","dataFixer/plugins/boxSlideShowDataFixer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa){"use strict";var ba=a.compact([d,f,A,B,C,g,t,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,e,x,y,z,X,D,E,F,G,H,I,J,L,M,K,N,O,P,Q,R,S,T,U,V,W,Y,b.isOpen("sv_popups")?$:null,Z,_,aa]);return function(b,d,e,f,g,h){var i=b.structure.id;return i=i?5===i.length||4===i.length?"":" "+i:" masterPage",c.performance.time("Fix page"+i,function(){var c=b.data||{};return c.document_data=c.document_data||{},c.theme_data=c.theme_data||{},c.component_properties=c.component_properties||{},b.data=c,a.forEach(ba,function(a){a.exec(b,d,e,f,g,h)}),b},!0)}}),define("dataFixer/plugins/deprecatedSiteModelMigrater",["lodash","coreUtils","dataFixer/core/fixPageData"],function(a,b,c){"use strict";function d(a){switch(a){case"wysiwyg.viewer.components.WSiteStructure":return"Document";case"mobile.core.components.Page":return"Page";case"wixapps.integration.components.Area":case"mobile.core.components.Container":case"wysiwyg.viewer.components.HeaderContainer":case"wysiwyg.viewer.components.FooterContainer":case"wysiwyg.viewer.components.PagesContainer":case"wysiwyg.viewer.components.ScreenWidthContainer":case"wysiwyg.viewer.components.StripContainer":return"Container"}return"Component"}function e(b,c,e,f,g){var h=a(f).pluck("name").invoke("toLowerCase").zipObject(a.pluck(f,"value")).value();"Page"===d(h.comp)&&(c.page=h.id),b.pagesData[c.page]=b.pagesData[c.page]||{structure:{},data:{},theme_data:{}};var i=b.pagesData[c.page].structure=b.pagesData[c.page].structure||{};if(a.has(c.childrenIndex,c.page)){for(var j=0;j<c.childrenIndex[c.page].length;j++)i=i.components[c.childrenIndex[c.page][j]];var k={};c.childrenIndex[c.page].push(i.components.length),i.components.push(k),i=k}else c.childrenIndex[c.page]=[];i.componentType=h.comp,i.type=d(h.comp),i.id=h.id,i.components=[],i.skin=h.skin,i.styleId=h.styleid,h.dataquery&&(i.dataQuery=h.dataquery),i.propertyQuery=h.propertyquery,i.layout={width:parseInt(h.width,10),height:parseInt(h.height,10),x:parseInt(h.x,10),y:parseInt(h.y,10),anchors:b.wixAnchors[h.id]||[]}}function f(a,b,c){0===b.childrenIndex[b.page].length?b.page="masterPage":b.childrenIndex[b.page].pop()}function g(d){d.pagesData={};var g=a.get(d,"wixData.document_data.SITE_STRUCTURE.mainPage")||a.get(d,"wixData.document_data.masterPage.mainPage"),h=g&&g.slice(1);d.pagesData.masterPage={data:d.wixData},d.pagesData.masterPage.structure={};var i={page:"masterPage",childrenIndex:{}};b.htmlParser(d.wixHtmlRaw,{start:e.bind(void 0,d,i),end:f.bind(void 0,d,i)});var j=a.keys(d.pagesData),k=a.without(j,"masterPage");d.pagesData.masterPage.data.document_data.MAIN_MENU=d.pagesData.masterPage.data.document_data.MAIN_MENU||{items:[],type:"Menu",id:"MAIN_MENU",metaData:{}},a.forEach(j,function(a){d.pagesData[a]=c(d.pagesData[a],k,d.requestModel,d.currentUrl,d.urlFormatModel)}),d.publicModel.pageList={mainPageId:h,pages:a.map(k,function(b){return a.chain(d).get(["pagesData","masterPage","data","document_data",b]).pick(["title","pageUriSEO"]).assign({pageId:b}).value()})}}return g}),define("dataFixer/plugins/fixBackgroundData",["lodash","imageClientApi","dataFixer/imageService/imageTransformDataFixers"],function(a,b,c){"use strict";function d(b){var c=b.getMasterPageData(),d=c.theme_data,h=c.document_data,i=a(h).filter({type:"BackgroundImage"}).map("id").value();f(h)||(e(h)?g(d,h):a.forEach(i,function(a){l(h[a])}))}function e(b){var c=a.find(b,{type:"Page"});return!b[c.id].pageBackgrounds}function f(b){var c=a.find(b,{type:"Page"});return b[c.id].pageBackgrounds&&"BackgroundMediaUnified"===b[c.id].pageBackgrounds.type}function g(b,c){var d="none 0 0 center center auto repeat repeat scroll none",e=a(c).filter({type:"Page"}).map("id").value(),f=b.THEME_DATA.siteBg||d,g=("[siteBg]"===b.THEME_DATA.mobileBg?b.THEME_DATA.siteBg:b.THEME_DATA.mobileBg)||d,j=i(f),k=i(g);j.id="customBgImg"+h(),k.id="customBgImg"+h([j.id]),c[j.id]=j,c[k.id]=k,a.forEach(e,function(a){c[a].pageBackgrounds={desktop:{custom:!0,isPreset:!1,ref:"#"+j.id},mobile:{custom:!0,isPreset:!1,ref:"#"+k.id}}})}function h(b){var c="";for(b=b||[];a.includes(b,c);)c=a.random(0,99999).toString(36).replace(" ","_");return c}function i(b){var c=a.compact(b.split(" "));return k.apply(this,c)}function j(a){var c={};return c[b.fittingTypes.TILE]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE,c[b.fittingTypes.TILE_HORIZONTAL]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,c[b.fittingTypes.TILE_VERTICAL]=b.fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,c[b.fittingTypes.ORIGINAL_SIZE]=b.fittingTypes.LEGACY_BG_NORMAL,c[a]||a}function k(a,b,d,e,f,g,h,i,k,l,m,n){var o=c.cssToAlignType(e+" "+f),p=c.cssToFittingType({bgRepeat:h+" "+i,bgSize:g});return p=j(p),m=m||{},l&&"none"!==l||(l="rgba(0,0,0,0)"),{type:"BackgroundMediaUnified",alignType:o,fittingType:p,attachment:k,imageWidth:Number(b),imageHeight:Number(d),mediaType:"image",uri:a,color:l,metaData:{isHidden:m.isHidden||!1,isPreset:m.isPreset||!1,schemaVersion:2},id:n}}function l(a){var b=[a.url,a.imagesizew,a.imagesizeh,a.positionx,a.positiony,a.width,a.repeatx,a.repeaty,a.attachment,a.color,a.metaData,a.id];return k.apply(this,b)}return{fixBackgroundData:d,migrateBgDataItem:l,migrateBgString:i}}),define("dataFixer",["dataFixer/core/fixPageData","dataFixer/plugins/deprecatedSiteModelMigrater","dataFixer/plugins/fixBackgroundData","dataFixer/imageService/imageTransformDataFixers","dataFixer/helpers/anchorCyclesHelper"],function(a,b,c,d,e){"use strict";return{fix:a,deprecatedSiteModelMigrater:b,fixBackgroundData:c,imageTransformDataFixers:d,anchorCyclesHelper:e}});